version: '3.8'

services:
  geoai-app:
    # Build the image from the Dockerfile in the current directory
    build:
      context: .
    container_name: geoai-app
    restart: unless-stopped

    # Load environment variables from a .env file for secrets like HUGGINGFACE_API_KEY
    env_file:
      - .env

    # Map the host port 8501 to the container's exposed port 8501
    ports:
      - "8501:8501"

    # Mount a local volume to persist logs generated by the application
    volumes:
      - ./logs:/app/logs

    # Enable GPU access for the container
    # Requires NVIDIA Container Toolkit to be installed on the host machine.
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1 # Request 1 GPU
              capabilities: [gpu]